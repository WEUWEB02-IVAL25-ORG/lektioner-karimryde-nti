<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Moonlander</title>
    <style>
        body {
            background: #272727;
        }

        canvas {
            background: #000;
            width: 700px;
            margin: auto;
            display: block;
        }
    </style>
</head>
<body>
    <canvas width="700" height="700"></canvas>
    <script>
        const c = document.querySelector('canvas')
        const ctx = c.getContext('2d')

        // Startposition
        x = 350
        y = 0

        // Hastighet
        dy = 1

        // Månens gravitation
        gravitation = 0.01

        // Variabel som håller koll på motorn
        let engineOn = false

        // Ladda ikonen
        const lander = new Image()
        lander.src = "./moon-landing.png"

        // Animationsloopen
        function gameLoop() {
            // Rensa canvas
            ctx.clearRect(0, 0, 700, 700)

            // När vi träffar månytan
            if (y <= 680 - 64) {
                // Ändring i fallhastighet
                dy += gravitation

                // Ändring i position ned till månytan = 680
                y += dy

                // Lyssna på tangenten mellanslag (space)
                window.addEventListener('keydown', function (e) {
                    if (e.code == 'Space') {
                        engineOn = true
                    }
                })
                window.addEventListener('keyup', function (e) {
                    if (e.code == 'Space') {
                        engineOn = false
                    }
                })

                // Om motorn är på
                if (engineOn) {
                    dy -= 0.1

                    // Rita ut raketlågan
                    ritaRaketlåga()
                }
            } else {
                dy = 0
            }

            // Rita ut instrumentpanel (HUD)
            ctx.fillStyle = "#fff"
            ctx.font = "20px Monospace"
            ctx.fillText("Hastighet: " + dy.toFixed(2), 10, 30)
            ctx.fillText("Höjd: " + (680 - 62.55 - y).toFixed(2), 10, 50)

            // Rita ut månytan
            ctx.fillStyle = "#444"
            ctx.fillRect(0, 680, 700, 20)

            // Rita ut månlandaren
            ctx.drawImage(lander, x, y)

            // Upprepa
            requestAnimationFrame(gameLoop)
        }
        gameLoop()

        function ritaRaketlåga() {
            ctx.beginPath()
            ctx.moveTo(x + 28, y + 50)
            ctx.lineTo(x + 20, y + 70)
            ctx.lineTo(x + 32, y + 70 + Math.random() * 30)
            ctx.lineTo(x + 42, y + 70)
            ctx.lineTo(x + 36, y + 50)
            ctx.fillStyle = "orange"
            ctx.fill()
        }
    </script>
</body>
</html>